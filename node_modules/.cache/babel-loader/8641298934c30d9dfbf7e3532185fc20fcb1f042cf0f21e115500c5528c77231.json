{"ast":null,"code":"var _jsxFileName = \"/Users/home/Desktop/33/duck/src/Page4.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Page4 = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const [previousValue, setPreviousValue] = useState(null);\n  const [currentValue, setCurrentValue] = useState(null);\n  const [rectangles, setRectangles] = useState([]);\n  const [centerPrice, setCenterPrice] = useState(null);\n  const fetchBitcoinPrice = async () => {\n    try {\n      const response = await axios.get('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');\n      const bitcoinPrice = Math.floor(response.data.bitcoin.usd);\n      return bitcoinPrice;\n    } catch (error) {\n      console.error('Ошибка при получении цены биткоина:', error);\n      return previousValue;\n    }\n  };\n  const generateNewValue = centerValue => {\n    const randomDiff = Math.floor(Math.random() * 691) - 345;\n    return centerValue + randomDiff;\n  };\n  useEffect(() => {\n    const drawCandle = (ctx, x, y1, y2, color) => {\n      const rectWidth = 20;\n      const startY = Math.min(y1, y2);\n      const height = Math.abs(y2 - y1);\n      ctx.fillStyle = color;\n      ctx.fillRect(x, startY, rectWidth, height);\n    };\n    const shiftCanvas = (ctx, canvas, shiftX) => {\n      const imageData = ctx.getImageData(shiftX, 0, canvas.width - shiftX, canvas.height);\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.putImageData(imageData, 0, 0);\n    };\n    const drawGraph = async () => {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      const scale = window.devicePixelRatio || 1;\n      canvas.width = 800 * scale;\n      canvas.height = 400 * scale;\n      ctx.scale(scale, scale);\n      const startPrice = await fetchBitcoinPrice();\n      setCenterPrice(startPrice);\n      setPreviousValue(startPrice);\n      const updateGraph = async () => {\n        const newValue = generateNewValue(previousValue || startPrice);\n        setCurrentValue(newValue);\n        const centerY = canvas.height / 2;\n        const priceRange = 1000; // Диапазон от -500 до +500\n        const previousY = centerY - (previousValue - centerPrice) / priceRange * canvas.height / 2;\n        const currentY = centerY - (newValue - centerPrice) / priceRange * canvas.height / 2;\n        const color = newValue > previousValue ? 'green' : 'red';\n        const rectWidth = 20;\n        drawCandle(ctx, canvas.width - rectWidth, previousY, currentY, color);\n        rectangles.push({\n          x: canvas.width - rectWidth,\n          y1: previousY,\n          y2: currentY,\n          color\n        });\n\n        // Проверка на выход за границы\n        if (newValue > centerPrice + 500 || newValue < centerPrice - 500) {\n          setCenterPrice(newValue);\n          shiftCanvas(ctx, canvas, rectWidth);\n          ctx.clearRect(canvas.width - rectWidth, 0, rectWidth, canvas.height);\n        }\n\n        // Смещение всех прямоугольников влево\n        rectangles.forEach(rect => {\n          rect.x -= rectWidth;\n        });\n        setRectangles(rectangles);\n\n        // Перерисовка всех прямоугольников\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        rectangles.forEach(rect => {\n          drawCandle(ctx, rect.x, rect.y1, rect.y2, rect.color);\n        });\n        setPreviousValue(newValue);\n        setTimeout(updateGraph, 20); // Делаем паузу перед отрисовкой следующего прямоугольника\n      };\n      updateGraph();\n    };\n    drawGraph();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        width: 800,\n        height: 400,\n        border: '1px solid black',\n        marginBottom: '20px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"\\u0422\\u0435\\u043A\\u0443\\u0449\\u0430\\u044F \\u0446\\u0435\\u043D\\u0430: \", currentValue]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n};\n_s(Page4, \"RyQ/nsA0tZOO6b+dse+1asAFqXc=\");\n_c = Page4;\nexport default Page4;\nvar _c;\n$RefreshReg$(_c, \"Page4\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","jsxDEV","_jsxDEV","Page4","_s","canvasRef","previousValue","setPreviousValue","currentValue","setCurrentValue","rectangles","setRectangles","centerPrice","setCenterPrice","fetchBitcoinPrice","response","get","bitcoinPrice","Math","floor","data","bitcoin","usd","error","console","generateNewValue","centerValue","randomDiff","random","drawCandle","ctx","x","y1","y2","color","rectWidth","startY","min","height","abs","fillStyle","fillRect","shiftCanvas","canvas","shiftX","imageData","getImageData","width","clearRect","putImageData","drawGraph","current","getContext","scale","window","devicePixelRatio","startPrice","updateGraph","newValue","centerY","priceRange","previousY","currentY","push","forEach","rect","setTimeout","style","display","flexDirection","alignItems","children","ref","border","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/home/Desktop/33/duck/src/Page4.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\n\nconst Page4 = () => {\n  const canvasRef = useRef(null);\n  const [previousValue, setPreviousValue] = useState(null);\n  const [currentValue, setCurrentValue] = useState(null);\n  const [rectangles, setRectangles] = useState([]);\n  const [centerPrice, setCenterPrice] = useState(null);\n\n  const fetchBitcoinPrice = async () => {\n    try {\n      const response = await axios.get('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');\n      const bitcoinPrice = Math.floor(response.data.bitcoin.usd);\n      return bitcoinPrice;\n    } catch (error) {\n      console.error('Ошибка при получении цены биткоина:', error);\n      return previousValue;\n    }\n  };\n\n  const generateNewValue = (centerValue) => {\n    const randomDiff = Math.floor(Math.random() * 691) - 345;\n    return centerValue + randomDiff;\n  };\n\n  useEffect(() => {\n    const drawCandle = (ctx, x, y1, y2, color) => {\n      const rectWidth = 20;\n      const startY = Math.min(y1, y2);\n      const height = Math.abs(y2 - y1);\n\n      ctx.fillStyle = color;\n      ctx.fillRect(x, startY, rectWidth, height);\n    };\n\n    const shiftCanvas = (ctx, canvas, shiftX) => {\n      const imageData = ctx.getImageData(shiftX, 0, canvas.width - shiftX, canvas.height);\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.putImageData(imageData, 0, 0);\n    };\n\n    const drawGraph = async () => {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      const scale = window.devicePixelRatio || 1;\n      canvas.width = 800 * scale;\n      canvas.height = 400 * scale;\n      ctx.scale(scale, scale);\n\n      const startPrice = await fetchBitcoinPrice();\n      setCenterPrice(startPrice);\n      setPreviousValue(startPrice);\n\n      const updateGraph = async () => {\n        const newValue = generateNewValue(previousValue || startPrice);\n        setCurrentValue(newValue);\n\n        const centerY = canvas.height / 2;\n        const priceRange = 1000; // Диапазон от -500 до +500\n        const previousY = centerY - ((previousValue - centerPrice) / priceRange) * canvas.height / 2;\n        const currentY = centerY - ((newValue - centerPrice) / priceRange) * canvas.height / 2;\n        \n        const color = newValue > previousValue ? 'green' : 'red';\n        const rectWidth = 20;\n\n        drawCandle(ctx, canvas.width - rectWidth, previousY, currentY, color);\n\n        rectangles.push({ x: canvas.width - rectWidth, y1: previousY, y2: currentY, color });\n\n        // Проверка на выход за границы\n        if (newValue > centerPrice + 500 || newValue < centerPrice - 500) {\n          setCenterPrice(newValue);\n          shiftCanvas(ctx, canvas, rectWidth);\n          ctx.clearRect(canvas.width - rectWidth, 0, rectWidth, canvas.height);\n        }\n\n        // Смещение всех прямоугольников влево\n        rectangles.forEach((rect) => {\n          rect.x -= rectWidth;\n        });\n\n        setRectangles(rectangles);\n\n        // Перерисовка всех прямоугольников\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        rectangles.forEach((rect) => {\n          drawCandle(ctx, rect.x, rect.y1, rect.y2, rect.color);\n        });\n\n        setPreviousValue(newValue);\n        setTimeout(updateGraph, 20); // Делаем паузу перед отрисовкой следующего прямоугольника\n      };\n\n      updateGraph();\n    };\n\n    drawGraph();\n  }, []);\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n      <canvas\n        ref={canvasRef}\n        style={{ width: 800, height: 400, border: '1px solid black', marginBottom: '20px' }}\n      ></canvas>\n      <div>Текущая цена: {currentValue}</div>\n    </div>\n  );\n};\n\nexport default Page4;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}